<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js?v=11"></script>
</head>
<body>
    <p>This add-in displays the selected text from the document *!*</p>
    <div id="selectedText"></div>
    <div id="logs"></div>
</body>
<script>
    function log(text) {
        try {
            document.getElementById('logs').innerText += text + '\n';
        } catch (error) {
            document.getElementById('logs').innerText += error + '\n';
        }
    }
    log('Add-in iniciado -1');
    log('Add-in iniciado -2');
    log('Office: ' + JSON.stringify(Office));
    log('Office.context: ' + JSON.stringify(Office.context));

    function initializeOffice() {
        try {
            log('initializeOffice');
            Office.onReady((info) => {
                log('Office.onReady - info: ' + info.host);
                if (info.host === Office.HostType.Word) {
                    log('Word: ', JSON.stringify(Word));
                    
                }
            })
        } catch (error) {
            log('initializeOffice - error: ' + error);
        }
    }
    initializeOffice();
    // Office.onReady((info) => {
    //     log('Office.onReady');
    //     log('info.host: ' + info.host);
    //     log('Office.HostType.Word: ' + Office.HostType.Word);

    //     if (info.host === Office.HostType.Word) {
    //         Word.document.addHandlerAsync('documentSelectionChanged', () => {
    //             log('addHandlerAsync');
    //             Word.run(context => {
    //                 log('Word.run');
    //                 const range = context.document.getSelection();
    //                 range.load('text');
    //                 return context.sync().then(() => {
    //                     log('context.sync');
    //                     const selectedTextElement = document.getElementById("selectedText");
    //                     selectedTextElement.textContent = "Texto selecionado: " + range.text;
    //                 });
    //             });
    //         });
    //     }
    // });

    // Office.initialize = () => {
    //     log('Office.initialize');
    //     log('Office.context.host: ' + Office.context.host);
    //     log('Office.HostType.Word: ' + Office.HostType.Word);
    //     if (Office.context.host === Office.HostType.Word) {
    //         log('if (Office.context.host === Office.HostType.Word)');
    //         Word.document.addHandlerAsync('documentSelectionChanged', () => {
    //             log('addHandlerAsync');
    //             Word.run(context => {
    //                 log('Word.run');
    //                 const range = context.document.getSelection();
    //                 range.load('text');
    //                 return context.sync().then(() => {
    //                     log('context.sync');
    //                     const selectedTextElement = document.getElementById("selectedText");
    //                     selectedTextElement.textContent = "Texto selecionado: " + range.text;
    //                 });
    //             });
    //         });
    //     }
    // };
</script>
</html>
